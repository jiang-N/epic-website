{"version":3,"sources":["logo.svg","components/Header.js","components/Footer.js","components/Loading.js","App.js","reportWebVitals.js","index.js","models/index.js","stores/user.js","stores/history.js","stores/image.js","stores/auth.js","stores/index.js"],"names":["Header","styled","header","Logo","img","StyledLink","NavLink","Login","div","StyledButton","Button","Component","observer","history","useHistory","useStores","UserStore","AuthStore","useEffect","pullUser","src","LogoUrl","alt","to","activeClassName","exact","currentUser","attributes","username","type","onClick","logout","console","log","push","Footer","footer","Loading","Home","lazy","History","About","Register","App","fallback","path","component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","document","getElementById","AV","init","appId","appKey","serverURL","Auth","password","user","User","setUsername","setPassword","Promise","resolve","reject","signUp","loginUser","error","logIn","logOut","current","Uploader","file","filename","item","Object","avFile","File","set","save","serverFile","page","limit","query","Query","include","skip","descending","equalTo","find","results","catch","makeObservable","this","observable","action","newList","list","concat","isLoading","append","length","hasMore","message","finally","newFilename","newFile","isUploading","err","values","resetUser","HistoryStore","reset","ImageStore","context","createContext","useContext"],"mappings":"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","file":"static/js/main.0ff0c85c.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import React,{useEffect} from 'react'\r\nimport LogoUrl from '../logo.svg'\r\nimport {NavLink, useHistory} from 'react-router-dom'\r\nimport styled from 'styled-components'\r\nimport {Button} from 'antd'\r\nimport {useStores} from '../stores'\r\nimport {observer} from 'mobx-react'\r\n\r\nconst Header = styled.header`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 10px 100px;\r\n  background-color: #02101f;\r\n  color: #fff;\r\n`\r\nconst Logo = styled.img`\r\n  height: 30px;\r\n`\r\nconst StyledLink = styled(NavLink)`\r\n  color: #fff;\r\n  margin-left: 30px;\r\n\r\n  &.active {\r\n    border-bottom: 1px solid #fff;\r\n  }\r\n`\r\nconst Login = styled.div`\r\n  margin-left: auto;\r\n`\r\n\r\nconst StyledButton = styled(Button)`\r\n  margin-left: 10px;\r\n`\r\n\r\nconst Component = observer(() => {\r\n  const history = useHistory()\r\n  const {UserStore, AuthStore} = useStores()\r\n\r\n  const handleLogout = () => {\r\n    AuthStore.logout()\r\n  }\r\n\r\n  const handleLogin = () => {\r\n    console.log('跳转到登录页面')\r\n    history.push('/login')\r\n  }\r\n\r\n  const handleRegister = () => {\r\n    console.log('跳转到注册页面')\r\n    history.push('/register')\r\n  }\r\n\r\n  useEffect(() => {\r\n    UserStore.pullUser()\r\n  })\r\n\r\n  return (\r\n    <Header>\r\n      <Logo src={LogoUrl} alt=\"logo\"/>\r\n      <nav>\r\n        <StyledLink to='/' activeClassName='active' exact>首页</StyledLink>\r\n        <StyledLink to='/history' activeClassName='active'>上传历史</StyledLink>\r\n        <StyledLink to='/about' activeClassName='active'>关于我</StyledLink>\r\n      </nav>\r\n      <Login>\r\n        {\r\n          UserStore.currentUser ? <>\r\n            {UserStore.currentUser.attributes.username} <StyledButton type='primary'\r\n                                                                      onClick={handleLogout}>注销</StyledButton>\r\n          </> : <>\r\n            <StyledButton type='primary' onClick={handleLogin}>登录</StyledButton>\r\n            <StyledButton type='primary' onClick={handleRegister}>注册</StyledButton>\r\n          </>\r\n        }\r\n      </Login>\r\n    </Header>\r\n  )\r\n})\r\n\r\nexport default Component","import React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nconst Footer = styled.footer`\r\n  padding: 10px 100px;\r\n  text-align: center;\r\n  font-size: 12px;\r\n  color: #aaa;\r\n`\r\n\r\nfunction Component() {\r\n  return (\r\n    <Footer>\r\n      <p>Footer</p>\r\n    </Footer>\r\n  )\r\n}\r\n\r\nexport default Component","import React from 'react'\r\n\r\nexport default function Loading() {\r\n  return (\r\n    <div>Loading...</div>\r\n  )\r\n}","import React, {Suspense, lazy} from 'react'\nimport './App.css'\nimport {Switch, Route} from 'react-router-dom'\nimport Header from './components/Header'\nimport Footer from './components/Footer'\nimport Loading from './components/Loading'\n\nconst Home = lazy(() => import('./pages/Home'))\nconst History = lazy(() => import('./pages/History'))\nconst About = lazy(() => import('./pages/About'))\nconst Login = lazy(() => import('./pages/Login'))\nconst Register = lazy(() => import('./pages/Register'))\n\nfunction App() {\n  return (\n    <>\n      <Header/>\n      <main>\n        <Suspense fallback={<Loading/>}>\n          <Switch>\n            <Route path='/' exact component={Home}/>\n            <Route path='/history' component={History}/>\n            <Route path='/about' component={About}/>\n            <Route path='/login' component={Login}/>\n            <Route path='/register' component={Register}/>\n          </Switch>\n        </Suspense>\n      </main>\n      <Footer/>\n    </>\n  )\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport 'antd/dist/antd.css'\nimport reportWebVitals from './reportWebVitals'\nimport {HashRouter as Router} from 'react-router-dom'\n\nReactDOM.render(\n  <Router>\n    <App/>\n  </Router>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n","import AV, {User} from 'leancloud-storage'\r\n\r\nAV.init({\r\n  appId: '91EgSCcUsxRrAcBJiYM9DKuo-gzGzoHsz',\r\n  appKey: 'LxwvCb4f6hmo3ctrhH1DwFGE',\r\n  serverURL: 'https://91egsccu.lc-cn-n1-shared.com'\r\n})\r\n\r\nconst Auth = {\r\n  register(username, password) {\r\n    let user = new User()\r\n    user.setUsername(username)\r\n    user.setPassword(password)\r\n    return new Promise((resolve, reject) => {\r\n      user.signUp().then(loginUser => resolve(loginUser), error => reject(error))\r\n    })\r\n  },\r\n  login(username, password) {\r\n    return new Promise((resolve, reject) => {\r\n      User.logIn(username, password).then(loginUser => resolve(loginUser), error => reject(error))\r\n    })\r\n  },\r\n  logout() {\r\n    return User.logOut()\r\n  },\r\n  getCurrentUser() {\r\n    return User.current()\r\n  }\r\n}\r\n\r\nconst Uploader = {\r\n  add(file, filename) {\r\n    const item = new AV.Object('Image')\r\n    const avFile = new AV.File(filename, file)\r\n    item.set('filename', filename)\r\n    item.set('owner', User.current())\r\n    item.set('url', avFile)\r\n    return new Promise((resolve, reject) => {\r\n      item.save().then(serverFile => resolve(serverFile), error => reject(error))\r\n    })\r\n  },\r\n  find({page = 0, limit = 10}) {\r\n    const query = new AV.Query('Image')\r\n    query.include('owner')\r\n    query.limit(limit)\r\n    query.skip(page * limit)\r\n    query.descending('createAt')\r\n    query.equalTo('owner', User.current())\r\n    return new Promise((resolve, reject) => {\r\n      query.find().then(results => resolve(results)).catch(error => reject(error))\r\n    })\r\n  }\r\n}\r\n\r\nexport {Auth, Uploader}","import {observable, action, makeObservable} from 'mobx'\r\nimport {Auth} from '../models'\r\n\r\nclass UserStore {\r\n  constructor() {\r\n    makeObservable(this)\r\n  }\r\n\r\n  @observable currentUser = null\r\n\r\n  @action pullUser() {\r\n    this.currentUser = Auth.getCurrentUser()\r\n  }\r\n\r\n  @action resetUser() {\r\n    this.currentUser = null\r\n  }\r\n}\r\n\r\nexport default new UserStore()","import {observable, action, makeObservable} from 'mobx'\r\nimport {Uploader} from '../models'\r\nimport {message} from 'antd'\r\n\r\nclass HistoryStore {\r\n  constructor() {\r\n    makeObservable(this)\r\n  }\r\n\r\n  @observable list = []\r\n  @observable isLoading = false\r\n  @observable hasMore = true\r\n  @observable page = 0\r\n  limit = 10\r\n\r\n  @action append(newList) {\r\n    this.list = this.list.concat(newList)\r\n  }\r\n\r\n  @action find() {\r\n    this.isLoading = true\r\n    Uploader.find({page: this.page, limit: this.limit}).then(newList => {\r\n      this.append(newList)\r\n      this.page++\r\n      if (newList.length < this.limit) {\r\n        this.hasMore = false\r\n      }\r\n    }).catch(() => {\r\n      return message.error('数据加载失败')\r\n    }).finally(() => {\r\n      this.isLoading = false\r\n    })\r\n  }\r\n\r\n  @action reset() {\r\n    this.list = []\r\n    this.isLoading = false\r\n    this.hasMore = true\r\n    this.page = 0\r\n  }\r\n}\r\n\r\nexport default new HistoryStore()","import {observable, action, makeObservable} from 'mobx'\r\nimport {Uploader} from '../models'\r\nimport {message} from 'antd'\r\n\r\nclass ImageStore {\r\n  constructor() {\r\n    makeObservable(this)\r\n  }\r\n\r\n  @observable filename = ''\r\n  @observable file = null\r\n  @observable isUploading = false\r\n  @observable serverFile = null\r\n\r\n  @action setFilename(newFilename) {\r\n    this.filename = newFilename\r\n  }\r\n\r\n  @action setFile(newFile) {\r\n    this.file = newFile\r\n  }\r\n\r\n  @action upload() {\r\n    this.isUploading = true\r\n    this.serverFile = null\r\n    return new Promise((resolve, reject) => {\r\n      Uploader.add(this.file, this.filename).then(serverFile => {\r\n        this.serverFile = serverFile\r\n        resolve(serverFile)\r\n      }).catch(err => {\r\n        message.error('上传失败')\r\n        reject(err)\r\n      }).finally(() => {\r\n        this.isUploading = false\r\n      })\r\n    })\r\n  }\r\n\r\n  @action reset() {\r\n    this.isUploading = false\r\n    this.serverFile = null\r\n  }\r\n}\r\n\r\nexport default new ImageStore()","import {observable, action, makeObservable} from 'mobx'\r\nimport {Auth} from '../models'\r\nimport UserStore from './user'\r\nimport HistoryStore from './history'\r\nimport ImageStore from './image'\r\nimport {message} from 'antd'\r\n\r\nclass AuthStore {\r\n  constructor() {\r\n    makeObservable(this)\r\n  }\r\n\r\n  @observable values = {\r\n    username: '',\r\n    password: ''\r\n  }\r\n\r\n  @action setUsername(username) {\r\n    this.values.username = username\r\n  }\r\n\r\n  @action setPassword(password) {\r\n    this.values.password = password\r\n  }\r\n\r\n  @action login() {\r\n    return new Promise((resolve, reject) => {\r\n      Auth.login(this.values.username, this.values.password).then(user => {\r\n        UserStore.pullUser()\r\n        resolve(user)\r\n      }).catch(err => {\r\n        UserStore.resetUser()\r\n        message.error('登录失败')\r\n        reject(err)\r\n      })\r\n    })\r\n  }\r\n\r\n  @action register() {\r\n    return new Promise((resolve, reject) => {\r\n      Auth.register(this.values.username, this.values.password).then(user => {\r\n        UserStore.pullUser()\r\n        resolve(user)\r\n      }).catch(err => {\r\n        UserStore.resetUser()\r\n        message.error('注册失败')\r\n        reject(err)\r\n      })\r\n    })\r\n  }\r\n\r\n  @action logout() {\r\n    UserStore.resetUser()\r\n    HistoryStore.reset()\r\n    ImageStore.reset()\r\n    return Auth.logout()\r\n  }\r\n}\r\n\r\nexport default new AuthStore()","import {createContext, useContext} from 'react'\r\nimport AuthStore from './auth'\r\nimport UserStore from './user'\r\nimport ImageStore from './image'\r\nimport HistoryStore from './history'\r\n\r\nconst context = createContext({\r\n  AuthStore, UserStore, ImageStore, HistoryStore\r\n})\r\n\r\nexport const useStores = () => useContext(context)"],"sourceRoot":""}